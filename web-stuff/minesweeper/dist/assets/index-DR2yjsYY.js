(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const f of i.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function r(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(l){if(l.ep)return;l.ep=!0;const i=r(l);fetch(l.href,i)}})();const D=document.querySelector(".buttons > .reset");D.onclick=()=>$();const A=document.querySelector(".buttons > .solve");A.onclick=()=>K();const T=document.querySelector(".gameover"),j=document.querySelector(".flagcounter > .counter"),a=document.querySelector(".main > .game > canvas"),s=a.getContext("2d",{alpha:!1}),v=window.devicePixelRatio||1;s.scale(v,v);s.imageSmoothingEnabled=!1;s.textRendering="optimizeLegibility";window.debug=!1;const P=parseFloat(getComputedStyle(document.documentElement).fontSize),O=Math.min(window.innerWidth,window.innerHeight-4*P-5*P);[a.width,a.height]=[O*v,O*v];a.style.width=O+"px";a.style.height=O+"px";const C=Math.min(a.clientWidth,a.clientHeight)*v,n=20,c=Math.floor(C/n),u=Array(n*n).fill(0),g=Array(n*n).fill(!1),d=Array(n*n).fill(!1),S=Array(n*n).fill(0),U=n*c,w=(C-U)/2/v;let y=!1;const k=64;let N=!0,F=!1;s.font=`${c}px sans-serif`;s.textBaseline="top";s.textAlign="center";const V={0:"transparent",1:"navy",2:"green",3:"maroon",4:"purple",5:"gold",6:"cyan",7:"olive",8:"grey"};function x(){s.fillStyle="#1a1a1a",s.fillRect(0,0,C,C);for(let t=0;t<n;t++)for(let e=0;e<n;e++){const[r,o]=Z(e,t);if(s.fillStyle=(t+e)%2===0?"bisque":"burlywood",s.fillRect(r,o,c,c),u[t*n+e]!==-1){s.fillStyle=V[u[t*n+e]];const[l,i]=W(u[t*n+e]);s.fillText(u[t*n+e],r+c/2,o+c/2+i)}else s.fillStyle="maroon",s.fillRect(r,o,c,c);if(g[t*n+e]||(s.fillStyle=(t+e)%2===0?"limegreen":"green",s.fillRect(r,o,c,c)),d[t*n+e]){s.fillStyle="red",s.font=`${c*.8}px sans-serif`;const[l,i]=W(u[t*n+e]);s.fillText("ðŸš©",r+c/2,o+c/2+i),s.font=`${c}px sans-serif`}window.debug&&F&&(s.fillStyle="black",s.textAlign="left",s.font=`${c*.4}px sans-serif`,S[t*n+e]>0&&s.fillText(S[t*n+e],r+2,o+2),s.font=`${c}px sans-serif`,s.textAlign="center"),j.innerHTML=k-d.reduce((l,i)=>l+i)}}function Z(t,e){return[w+t*c,w+e*c]}function R(t){const e=t%n,r=(t-e)/n;return[e,r]}function W(t){const e=s.measureText(t),r=e.actualBoundingBoxAscent-e.actualBoundingBoxDescent;return[e.width/2,r/2]}function Y(){for(let t=0;t<k;t++){let e=Math.floor(Math.random()*n*n);u[e]===-1?t--:u[e]=-1}for(let t=0;t<n;t++)for(let e=0;e<n;e++)u[t*n+e]!==-1&&(u[t*n+e]=G(e,t).reduce((r,o)=>r+(u[o[1]*n+o[0]]===-1),0))}function G(t,e){let r=Array(9),o=0;for(let l=-1;l<=1;l++)for(let i=-1;i<=1;i++)r[o]=[t+i,e+l],o++;return r[4]=[-1,-1],r.filter(l=>l[0]>=0&&l[1]>=0&&l[0]<=n-1&&l[1]<=n-1)}function X(t,e){const r=Math.floor((t-(a.clientLeft+w))/(a.clientWidth-w*2)*n),o=Math.floor((e-(a.clientTop+w))/(a.clientHeight-w*2)*n);return(r<0||o<0||r>n-1||o>n-1)&&console.log("POINTER ERROR OUT OF BOUNDS, pos: ",r,o),[r,o]}a.onclick=t=>{t.preventDefault(),y&&I();const[e,r]=X(t.offsetX,t.offsetY);L(e,r),x()};a.oncontextmenu=t=>{t.preventDefault();const[e,r]=X(t.offsetX,t.offsetY);B(e,r),x()};function L(t,e){if(y||d[e*n+t]===!0)return;if(N){for(let l=0;l<1e3&&u[e*n+t]!==0;l++)console.log(`regen attempt #${l}.`),$(),l===0&&console.log("(just making sure you don't lose on the first turn)");N=!1}if(u[e*n+t]===-1){E();return}let r=new Set().add(e*n+t),o=new Set;for(let l of r){if(u[l]===0)for(let i of G(...R(l)).map(f=>f[1]*n+f[0]))!o.has(i)&&u[i]!==-1&&r.add(i);o.add(l)}for(let l of r)g[l]=!0;z()}function B(t,e){y||g[e*n+t]!==!0&&(d[e*n+t]=!d[e*n+t],z())}function z(){let t=!0,e=!0;for(let o=0;o<u.length;o++)u[o]!==-1&&g[o]!==!0&&(t=!1);for(let o=0;o<u.length;o++)u[o]===-1&&d[o]!==!0&&(e=!1);e=e&&k-d.reduce((o,l)=>o+l)>=0,(t||e)&&E(!0)}function E(t=!1){t&&(T.innerHTML="You Win!"),a.style.filter="blur(5px)",T.style.display="block",y=!0}function I(){a.style="",a.style.width=O+"px",a.style.height=O+"px",T.style="",T.innerHTML="Game Over"}function $(){u.fill(0),g.fill(!1),d.fill(!1),S.fill(0),Y(),I(),ne(),x(),y=!1,N=!0}function K(){if(!y){if(F)return _();requestAnimationFrame(N?()=>{L(Math.floor((n-1)/2),Math.floor((n-1)/2)),x(),requestAnimationFrame(()=>q(0,!0))}:()=>q(0,!0))}}function q(t=0,e=!1){let r=g.reduce((i,f)=>i+f)+d.reduce((i,f)=>i+f);for(let i=0;i<n;i++)for(let f=0;f<n;f++)if(g[i*n+f]===!0&&u[i*n+f]>0){let h=u[i*n+f],p=G(f,i),M=p.filter(m=>!g[m[1]*n+m[0]]),b=p.filter(m=>d[m[1]*n+m[0]]);if(h===b.length)for(let m of M.filter(H=>!d[H[1]*n+H[0]]))L(m[0],m[1])}x();for(let i=0;i<n;i++)for(let f=0;f<n;f++)if(g[i*n+f]===!0&&u[i*n+f]>0){let h=u[i*n+f],M=G(f,i).filter(b=>!g[b[1]*n+b[0]]);if(h===M.length)for(let b of M.filter(m=>!d[m[1]*n+m[0]]))B(b[0],b[1])}x();let l=g.reduce((i,f)=>i+f)+d.reduce((i,f)=>i+f)-r;return l===0&&!y&&te(),l===0||y?1:(e&&requestAnimationFrame(()=>q(t+1,!0)),0)}function J(t){let e=0,r=!1;for(let o=1;o<t.length;o++)!r&&t[o]>0&&(r=!0,e=o),t[o]>0&&t[o]<t[e]&&(e=o);return e}function Q(t){let e=0;for(let r=1;r<t.length;r++)t[r]>t[e]&&(e=r);return e}function _(){console.log("guessing"),requestAnimationFrame(()=>{ee(!0),q(0,!0)})}function ee(t=!1){S.fill(0);for(let e=0;e<n;e++)for(let r=0;r<n;r++)if(g[e*n+r]===!0&&u[e*n+r]>0){let o=u[e*n+r],l=G(r,e),i=l.filter(h=>!g[h[1]*n+h[0]]),f=l.filter(h=>d[h[1]*n+h[0]]);if(i.length>f.length){let h=i.filter(p=>!d[p[1]*n+p[0]]);for(let p of h)S[p[1]*n+p[0]]+=o/h.length}}if(t){const e=Q(S);B(...R(e))}else{const e=J(S);L(...R(e))}x()}function te(){A.innerHTML="Guess",A.style.background="coral",F=!0}function ne(){A.innerHTML="Solve",A.style="",F=!1}Y();x();
